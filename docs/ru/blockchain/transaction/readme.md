# Транзакция

**Транзакция** — действие на [блокчейне](/ru/blockchain/blockchain/) от имени [аккаунта](/ru/blockchain/account/). 

В Waves предусмотрено множество типов транзакций. Например:

* транзакция данных записывает информацию в хранилище данных аккаунта;
* транзакция перевода отправляет заданное количество токенов с одного аккаунта на другой.

Набор полей транзакции зависит от ее типа. Типы транзакций перечислены в разделе [Тип транзакции](/ru/blockchain/transaction-type/).

## Подтверждение транзакции

В Waves каждая транзакция отправлена с какого-либо аккаунта. Транзакция, отправленная с обычного аккаунта (на котором не установлен скрипт), должна содержать подтверждение — цифровую подпись отправителя. Смарт-аккаунты и dApp могут устанавливать собственные правила верификации исходящих транзакций. ) Подробнее см. в разделе [Подтверждение транзакциии](/ru/blockchain/transaction/transaction-proof).

## Комиссия за транзакцию

Транзакции в Waves очень дешевые, но не бесплатные. В каждой транзакции должна быть указана комиссия не менее минимальной. Минимальные комиссии представлены в разделе [Комиссия за транзакцию](/ru/blockchain/transaction/transaction-fee).

## JSON-представление транзакции

В [REST API](/ru/waves-node/node-api/) ноды Waves используется JSON-представление транзакции. Пример JSON-представления:

```json
{
    "senderPublicKey":"BVv1ZuE3gKFa6krwWJQwEmrLYUESuUabNCXgYTmCoBt6",
    "sender":"3N8S4UtauvDAzpLiaRyDdHn9muexWHhBP4D",
    "feeAssetId":null,
    "proofs":["22QJfRKX7kUQt4qjdnUqZAnhqukqhnofE27uvP8Q5xnBf8M6PCNtWVGq2ngm6m7Voe7duys59D1yU9jhKrmdXDCe"],
    "fee":100000,
    "alias":"91f452553298770f",
    "id":"AD7KmXwoVNc2fXsmaxsHsrnT1tfPF3HsWYtfjFijVsvM",
    "type":10,
    "version":2,
    "applicationStatus": "succeed",
    "timestamp":1548443069053,
    "height":466104
}
```

| Поле | Описание |
| :--- | :--- |
| senderPublicKey | [Открытый ключ](/ru/blockchain/account/#открытый-и-закрытый-кnючи-аккаунта) аккаунта, с которого отправлена транзакция, в кодировке base58 |
| *sender* | [Адрес](/ru/blockchain/account/address) аккаунта, с которого отправлена транзакция, в кодировке base58 |
| feeAssetId | ID токена, в котором указана комиссия.<br>`null` означает, что комиссия указана в WAVES.<br>Для транзакций вызова скрипта и транзакций перевода комиссия может быть указана в спонсорском ассете, см. раздел [Спонсирование комиссии](/ru/blockchain/waves-protocol/sponsored-fee) |
| proofs | Массив [подтверждений транзакции](/ru/blockchain/transaction/transaction-proof), используемых для проверки валидности. Может содержать подписи транзакции (но не ограничивается только подписями) |
| fee | [Комиссия за транзакцию](/ru/blockchain/transaction/transaction-fee). Всегда целое число, выраженное в минимальных неделимых единицах («копейках») ассета. Например, если комиссия составляет 0,001 WAVES, в JSON-представлении указывается 100000 |
| *id* | Идентификатор транзакции. Подробнее в разделе [Вычисление ID транзакции](/en/blockchain/waves-protocol/cryptographic-practical-details#calculating-transaction-id).
| type | Тип транзакции. Номера типов представлены в разделе [Тип транзакции](/ru/blockchain/transaction-type/) |
| version | Версия транзакции.<br>Список версий для каждого типа транзакции см. в описании [бинарных форматов транзакции](/ru/blockchain/binary-format/transaction-binary-format) |
| applicationStatus | Результат валидации:<br>- succeed — валидация прошла успешно.<br>- scriptExecutionFailed — результат выполнения dApp-скрипта или скрипта ассета был неудачным.<br>Поле появилось в версии ноды 1.2.4, после активации фичи № 15 “Ride V4, VRF, Protobuf, Failed transactions”. [Подробнее о валидации транзакций](/ru/blockchain/transaction/transaction-validation) |
| timestamp | Временная метка транзакции, указанная отправителем: Unix-время в миллисекундах. Транзакция не будет добавлена в блокчейн, если значение временной метки транзакции отличается от временной метки текущего блока более чем на 2 часа назад или 1,5 часа вперед. |
| *height* | Порядковый номер блока, в который была добавлена транзакция |

Поля `sender`, `id`, `height` не нужно заполнять при отправке транзакции, и они не хранятся на блокчейне: их вычисляет нода при предоставлении данных о транзакции через REST API.

> В ранних версиях некоторых типов транзакций вместо массива `proofs` используется поле `signature`, содержащее подпись транзакции.

Описание полей, зависящих от типа транзакции, представлено в описании [типов транзакций](/ru/blockchain/transaction/transaction-type/).

## Бинарный формат транзакции

Транзакции хранятся на блокчейне в бинарном формате (байтовом представлении). [Расширения](/ru/waves-node/extensions/) ноды, в частности [gRPC-сервер](/ru/waves-node/extensions/grpc-server/), могут работать непосредственно с данными в бинарном формате.

Подпись транзакции и ее идентификатор также формируются на основе бинарного формата, а именно байтов тела транзакции — всех полей, за исключением идентификатора и подтверждений (или, в зависимости от версии транзакции, идентификатора и подписи). Правила генерации подписи и идентификатора транзакции рассмотрены в разделе [Cryptographic practical details](/en/blockchain/waves-protocol/cryptographic-practical-details#signing).

Описание бинарного формата транзакции приведено в разделе [Бинарный формат транзакции](/ru/blockchain/binary-format/transaction-binary-format/).

## Примеры транзакций

Коллекция транзакций по типам представлена в разделе [Примеры транзакций](/ru/waves-node/node-api/example-transactions).

Получить транзакцию по ее идентификатору, адресу аккаунта или получить список всех транзакций в блоке можно:

* В [Waves Explorer](https://wavesexplorer.com/).
* С помощью методов [Node REST API](/ru/waves-node/node-api/):

   * `GET /transactions/info/{id}`
   * `GET /transactions/address/{address}/limit/{limit}`
   * `GET /blocks/at/{height}`

## Как подписать и отправить транзакцию

* В [Waves IDE](https://waves-ide.com/) с помощью инструмента Transaction Signing Tool (картинка).
* С помощью одной из [клиентских библиотек](/ru/building-apps/waves-api-and-sdk/client-libraries/). См. также примеры в разделе [Создание и отправка транзакций](/ru/building-apps/how-to/basic/transaction).
* В приложении [Waves.Exchange](https://waves.exchange/), разработанном командой Waves.Exchange, доступно создание некоторых типов транзакций, таких как перевод токена, выпуск/довыпуск/сжигание токена, настройка спонсирования, установка скрипта ассета, создание псевдонима.
* С помощью [Node REST API](/ru/waves-node/node-api/):

   * метод `POST /transactions/broadcast` позволяет отправить на ноду уже подписанную транзакцию;
   * метод `POST /transactions/sign` позволяет сгенерировать подпись транзакции (однако этот метод доступен только владельцу ноды).

## Что происходит с транзакцией после отправки

Получив транзакцию, нода проверяет ее валидность: корректность подписи, достаточность баланса отправителя и др. (подробнее см. в разделе [Валидация транзакции](/ru/blockchain/transaction/transaction-validation). Если транзакция валидна, нода добавляет транзакцию в UTX pool — список транзакций, ожидающих попадания в блок. Далее нода передает эту транзакцию другим нодам сети блокчейна.

У блока есть ограничения на размер (1 Мбайт) и количество транзакций (6000), поэтому транзакция может попасть в блок не сразу. В первую очередь ноды добавляют в блок самые «выгодные» транзакции — с наибольшей комиссией за байт.

Транзакция из UTX pool может так и не попасть на блокчейн, если во время нахождения в UTX pool она стала невалидной. Например, истекло время жизни транзакции: временная метка оказалась более чем на 2 часа в прошлом относительно текущего времени. Или другая транзакция попала в блок, изменила состояние блокчейна, и баланс отправителя оказался недостаточен для выполнения транзакции.
